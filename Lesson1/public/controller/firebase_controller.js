import * as Constant from "../model/constant.js";
import { Thread } from "../model/thread.js";

export async function signIn(email, password) {
  await firebase.auth().signInWithEmailAndPassword(email, password);
}

export async function signOut() {
  await firebase.auth().signOut();
}

export async function addThread(thread) {
  const ref = await firebase
    .firestore()
    .collection(Constant.collectionName.THREAD)
    .add(thread.serialize());

  return ref.id; //unique doc id generated by firestore
}

export async function getThreadList() {
  let threadList = [];
  const snapShot = await firebase.firestore().collection(Constant.collectionName.THREAD)
    .orderBy("timestamp", "desc")
    .get();
  snapShot.forEach((doc) => {
    const t = new Thread(doc.data());
    t.docId = doc.id;
    threadList.push(t);
  });
  return threadList
}

export async function getOneThread(threadID) {
  const ref = await firebase
    .firestore()
    .collection(Constant.collectionName.THREAD)
    .doc(threadID).get();
  const t = new Thread(ref.data());
  t.docID = threadID;
    return t
}
